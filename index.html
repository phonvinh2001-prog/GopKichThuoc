<!doctype html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>T·ªëi ∆Øu H√≥a C·∫Øt Nh√¥m</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="src/css/styles.css" />
  </head>
  <body>
    <div class="container">
      <!-- Header -->
      <header class="header">
        <h1>
          <svg
            width="32"
            height="32"
            fill="none"
            stroke="var(--primary)"
            stroke-width="2.5"
            viewBox="0 0 24 24"
            style="margin-top: -4px"
          >
            <path
              d="M14.7 6.3a1 1 0 000 1.4l1.6 1.6a1 1 0 001.4 0l3.77-3.77a2 2 0 012.83 0l.3.3a2 2 0 010 2.83l-3.77 3.77a1 1 0 000 1.4l1.6 1.6a1 1 0 001.4 0l3.77-3.77a2 2 0 012.83 0l.3.3a2 2 0 010 2.83l-3.77 3.77a1 1 0 000 1.4l1.6 1.6a1 1 0 001.4 0"
            ></path>
            <path d="M21 21l-6-6m-4 4L5 13m14-4L5 5"></path>
          </svg>
          GopKichThuoc
        </h1>
        <p class="subtitle">H·ªá th·ªëng t·ªëi ∆∞u h√≥a c·∫Øt nh√¥m chuy√™n nghi·ªáp</p>
      </header>

      <!-- Main Content -->
      <div class="main-grid">
        <!-- Left Panel: Input Form -->
        <section class="panel input-panel">
          <div class="panel-header">
            <h2>Thi·∫øt l·∫≠p</h2>
            <div class="header-actions">
              <button
                id="btnImport"
                class="btn btn-secondary"
                title="Nh·∫≠p d·ªØ li·ªáu"
              >
                <svg
                  width="18"
                  height="18"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  viewBox="0 0 24 24"
                >
                  <path
                    d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"
                  ></path>
                </svg>
              </button>
              <button
                id="btnSaveTemplate"
                class="btn btn-secondary"
                title="L∆∞u m·∫´u"
              >
                <svg
                  width="18"
                  height="18"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  viewBox="0 0 24 24"
                >
                  <path
                    d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"
                  ></path>
                </svg>
              </button>
              <button
                id="btnClearItems"
                class="btn btn-secondary"
                title="X√≥a h·∫øt"
                style="color: var(--danger)"
              >
                <svg
                  width="18"
                  height="18"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  viewBox="0 0 24 24"
                >
                  <path
                    d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
                  ></path>
                </svg>
              </button>
            </div>
          </div>

          <!-- Danh s√°ch chi ti·∫øt -->
          <div class="form-group">
            <div class="section-title">Chi ti·∫øt s·∫£n ph·∫©m</div>
            <div class="item-input-row">
              <input type="number" id="itemLength" placeholder="D√†i (mm)" />
              <input type="number" id="itemQuantity" placeholder="SL" />
              <button class="btn btn-add" onclick="app.addItem()">+</button>
            </div>
            <div id="itemsList" class="items-list"></div>
          </div>

          <!-- Qu·∫£n l√Ω t·ªìn kho -->
          <div class="inventory-section">
            <div class="section-title">Thanh t·ªìn kho (T√πy ch·ªçn)</div>
            <div class="item-input-row">
              <input type="number" id="stockLength" placeholder="D√†i (mm)" />
              <input type="number" id="stockQuantity" placeholder="SL" />
              <button class="btn btn-add" onclick="app.addStock()">+</button>
            </div>
            <div id="stockList" class="items-list"></div>
          </div>

          <!-- C√†i ƒë·∫∑t thu·∫≠t to√°n -->
          <div class="settings-section">
            <div class="section-title">C√†i ƒë·∫∑t n√¢ng cao</div>
            <div class="form-row">
              <div class="form-group">
                <label>M·∫°ch c·∫Øt (mm)</label>
                <input type="number" id="kerf" value="5" />
              </div>
              <div class="form-group">
                <label>Ph·∫ø li·ªáu t·ªëi ƒëa (mm)</label>
                <input type="number" id="maxWaste" value="500" />
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label>D√†i Min (mm)</label>
                <input type="number" id="minLength" value="3500" />
              </div>
              <div class="form-group">
                <label>D√†i Max (mm)</label>
                <input type="number" id="maxLength" value="6000" />
              </div>
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="action-buttons">
            <button class="btn btn-primary" onclick="app.calculate()">
              üßÆ T√≠nh to√°n
            </button>
            <button class="btn btn-secondary" onclick="app.clearAll()">
              L√†m m·ªõi
            </button>
          </div>
        </section>

        <!-- Middle Panel: Results -->
        <section class="panel result-panel">
          <div class="panel-header">
            <h2>S∆° ƒë·ªì c·∫Øt t·ªëi ∆∞u</h2>
          </div>
          <div id="resultArea" class="result-area">
            <div class="empty-state">
              <p>Ch∆∞a c√≥ k·∫øt qu·∫£ t√≠nh to√°n</p>
            </div>
          </div>

          <div
            id="cuttingDiagram"
            class="cutting-diagram"
            style="display: none"
          ></div>
          <div
            id="summaryTable"
            class="summary-table"
            style="display: none"
          ></div>
        </section>

        <!-- Right Panel: Statistics & Actions -->
        <section class="panel stats-panel">
          <div class="panel-header">
            <h2>Hi·ªáu s·ªë & B√°o c√°o</h2>
          </div>

          <div id="statsArea" class="stats-area">
            <!-- Stats populated by JS -->
          </div>

          <!-- Export Actions -->
          <div class="export-section">
            <div class="section-title" style="margin-top: 2rem">H√†nh ƒë·ªông</div>
            <button
              class="btn btn-success"
              onclick="app.exportExcel()"
              disabled
              id="btnExportExcel"
            >
              üìÑ Xu·∫•t Excel b√°o c√°o
            </button>
            <button
              class="btn btn-secondary"
              onclick="app.printResults()"
              disabled
              id="btnPrint"
              style="width: 100%; margin-top: 0.5rem"
            >
              üñ®Ô∏è In s∆° ƒë·ªì (PDF)
            </button>
          </div>

          <!-- Warnings -->
          <div
            id="warningsArea"
            class="warnings-area"
            style="display: none"
          ></div>
        </section>
      </div>

      <!-- Modal Import -->
      <div id="importModal" class="modal">
        <div class="modal-content">
          <span class="close-modal">&times;</span>
          <div class="section-title">Nh·∫≠p d·ªØ li·ªáu nhanh</div>

          <div class="import-tabs">
            <button class="tab-btn active" data-tab="paste">
              üìã D√°n Excel
            </button>
            <button class="tab-btn" data-tab="file">üìÇ Ch·ªçn File</button>
          </div>

          <!-- Tab Paste -->
          <div id="tabPaste" class="tab-content active">
            <p class="hint">
              Copy v√† d√£n d·ªØ li·ªáu (D√†i - S·ªë l∆∞·ª£ng) t·ª´ Excel v√†o ƒë√¢y:
            </p>
            <textarea
              id="pasteArea"
              rows="8"
              placeholder="5300 15&#10;2050 18&#10;3250 90"
            ></textarea>
            <div style="margin-top: var(--spacing-md); text-align: right">
              <button id="btnProcessPaste" class="btn btn-primary">
                X·ª≠ l√Ω ngay
              </button>
            </div>
          </div>

          <!-- Tab File -->
          <div id="tabFile" class="tab-content">
            <div class="file-drop-area" id="dropZone">
              <p>Th·∫£ file Excel (.xlsx) v√†o ƒë√¢y ho·∫∑c</p>
              <input type="file" id="fileInput" accept=".xlsx, .xls, .csv" />
              <label
                for="fileInput"
                class="btn btn-secondary"
                style="margin-top: 1rem"
                >Ch·ªçn File t·ª´ m√°y</label
              >
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none">
      <div class="spinner"></div>
      <p>ƒêang t√≠nh to√°n...</p>
    </div>

    <!-- Libraries -->
    <!-- S·ª≠ d·ª•ng version 0.18.5 ·ªïn ƒë·ªãnh t·ª´ cdnjs -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <!-- App Scripts -->
    <script src="src/js/optimizer.js"></script>
    <script src="src/js/storage.js"></script>
    <script src="src/js/export.js"></script>
    <script src="src/js/app.js"></script>
  </body>
</html>
