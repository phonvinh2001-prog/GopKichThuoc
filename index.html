<!doctype html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>T·ªëi ∆Øu H√≥a C·∫Øt Nh√¥m</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="src/css/styles.css" />
  </head>
  <body>
    <div class="container">
      <!-- Header -->
      <header class="header">
        <h1>üîß T·ªëi ∆Øu H√≥a C·∫Øt Nh√¥m</h1>
        <p class="subtitle">
          T√≠nh to√°n k√≠ch th∆∞·ªõc ph√¥i nh√¥m t·ªëi ∆∞u - Gi·∫£m thi·ªÉu ph·∫ø li·ªáu
        </p>
      </header>

      <!-- Main Content -->
      <div class="main-grid">
        <!-- Left Panel: Input Form -->
        <section class="panel input-panel">
          <div class="panel-header">
            <h2>üì• Nh·∫≠p li·ªáu</h2>
            <div class="header-actions">
              <button
                id="btnImport"
                class="btn-secondary"
                title="Nh·∫≠p t·ª´ Excel/Copy"
              >
                üìÇ Import
              </button>
              <button
                id="btnClearItems"
                class="btn-secondary"
                title="X√≥a t·∫•t c·∫£ danh s√°ch"
                style="color: #dc3545; border-color: #dc3545"
              >
                üóëÔ∏è Clear
              </button>
              <button
                id="btnSaveTemplate"
                class="btn-secondary"
                title="L∆∞u danh s√°ch l√†m m·∫´u"
              >
                üíæ L∆∞u
              </button>
            </div>
          </div>

          <!-- Modal Import -->
          <div id="importModal" class="modal" style="display: none">
            <div class="modal-content">
              <span class="close-modal">&times;</span>
              <h3>üìã Nh·∫≠p d·ªØ li·ªáu nhanh</h3>

              <div class="import-tabs">
                <button class="tab-btn active" data-tab="paste">
                  üìã D√°n n·ªôi dung
                </button>
                <button class="tab-btn" data-tab="file">üìÇ Ch·ªçn file</button>
              </div>

              <!-- Tab Paste -->
              <div id="tabPaste" class="tab-content active">
                <p class="hint">
                  Copy t·ª´ Excel (C·ªôt A: Chi·ªÅu d√†i, C·ªôt B: S·ªë l∆∞·ª£ng) r·ªìi d√°n v√†o
                  ƒë√¢y:
                </p>
                <textarea
                  id="pasteArea"
                  rows="10"
                  placeholder="V√≠ d·ª•:\n5300 15\n2050 18\n3250 90"
                ></textarea>
                <div class="action-buttons">
                  <button id="btnProcessPaste" class="btn-primary">
                    Nh·∫≠p d·ªØ li·ªáu
                  </button>
                </div>
              </div>

              <!-- Tab File -->
              <div id="tabFile" class="tab-content" style="display: none">
                <div class="file-drop-area" id="dropZone">
                  <p>K√©o th·∫£ file Excel/CSV v√†o ƒë√¢y ho·∫∑c</p>
                  <input
                    type="file"
                    id="fileInput"
                    accept=".xlsx, .xls, .csv"
                  />
                  <label for="fileInput" class="btn-secondary">Ch·ªçn File</label>
                </div>
                <p class="hint">File c·∫ßn c√≥ c·ªôt "Chi·ªÅu d√†i" v√† "S·ªë l∆∞·ª£ng"</p>
              </div>
            </div>
          </div>

          <!-- Danh s√°ch chi ti·∫øt -->
          <div class="form-group">
            <label>Danh s√°ch chi ti·∫øt</label>
            <div class="item-input-row">
              <input
                type="number"
                id="itemLength"
                placeholder="Chi·ªÅu d√†i (mm)"
                min="1"
              />
              <input
                type="number"
                id="itemQuantity"
                placeholder="S·ªë l∆∞·ª£ng"
                min="1"
              />
              <button class="btn btn-add" onclick="app.addItem()">
                + Th√™m
              </button>
            </div>
            <div id="itemsList" class="items-list"></div>
          </div>

          <!-- C√†i ƒë·∫∑t -->
          <div class="settings-section">
            <h3>‚öôÔ∏è C√†i ƒë·∫∑t</h3>

            <div class="form-group">
              <label>M·∫°ch c·∫Øt (mm)</label>
              <input type="number" id="kerf" value="5" min="0" step="0.1" />
              <small>ƒê·ªô d√†y l∆∞·ª°i c∆∞a</small>
            </div>

            <div class="form-group">
              <label>Ph·∫ø li·ªáu t·ªëi ƒëa cho ph√©p (mm)</label>
              <input type="number" id="maxWaste" value="500" min="0" />
              <small>Ng∆∞·ª°ng c·∫£nh b√°o ph·∫ø li·ªáu</small>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label>Min (mm)</label>
                <input type="number" id="minLength" value="3500" min="1000" />
              </div>
              <div class="form-group">
                <label>Max (mm)</label>
                <input type="number" id="maxLength" value="6000" min="1000" />
              </div>
            </div>

            <div class="form-group">
              <label>B∆∞·ªõc nh·∫£y (mm)</label>
              <input type="number" id="stepSize" value="100" min="10" />
              <small>Kho·∫£ng c√°ch gi·ªØa c√°c k√≠ch th∆∞·ªõc th·ª≠</small>
            </div>
          </div>

          <!-- Qu·∫£n l√Ω t·ªìn kho -->
          <div class="inventory-section">
            <h3>üì¶ T·ªìn kho (Thanh c·ª•t)</h3>
            <div class="item-input-row">
              <input
                type="number"
                id="stockLength"
                placeholder="Chi·ªÅu d√†i (mm)"
                min="1"
              />
              <input
                type="number"
                id="stockQuantity"
                placeholder="S·ªë l∆∞·ª£ng"
                min="1"
              />
              <button class="btn btn-secondary" onclick="app.addStock()">
                + Th√™m t·ªìn
              </button>
            </div>
            <div id="stockList" class="items-list"></div>
          </div>

          <!-- Action Buttons -->
          <div class="action-buttons">
            <button class="btn btn-primary" onclick="app.calculate()">
              üßÆ T√≠nh to√°n
            </button>
            <button class="btn btn-secondary" onclick="app.clearAll()">
              üóëÔ∏è X√≥a t·∫•t c·∫£
            </button>
          </div>
        </section>

        <!-- Middle Panel: Results -->
        <section class="panel result-panel">
          <h2>üìä K·∫øt qu·∫£</h2>
          <div id="resultArea" class="result-area">
            <div class="empty-state">
              <svg width="120" height="120" viewBox="0 0 120 120" fill="none">
                <circle
                  cx="60"
                  cy="60"
                  r="50"
                  stroke="#e0e0e0"
                  stroke-width="4"
                />
                <path
                  d="M40 60h40M60 40v40"
                  stroke="#e0e0e0"
                  stroke-width="4"
                  stroke-linecap="round"
                />
              </svg>
              <p>Nh·∫≠p d·ªØ li·ªáu v√† nh·∫•n "T√≠nh to√°n" ƒë·ªÉ xem k·∫øt qu·∫£</p>
            </div>
          </div>

          <!-- Cutting Diagram -->
          <div
            id="cuttingDiagram"
            class="cutting-diagram"
            style="display: none"
          ></div>

          <!-- Summary Table -->
          <div
            id="summaryTable"
            class="summary-table"
            style="display: none"
          ></div>
        </section>

        <!-- Right Panel: Statistics & Actions -->
        <section class="panel stats-panel">
          <h2>üìà Th·ªëng k√™</h2>
          <div id="statsArea" class="stats-area">
            <div class="stat-card">
              <div class="stat-label">Hi·ªáu su·∫•t</div>
              <div class="stat-value" id="efficiency">--%</div>
            </div>
            <div class="stat-card">
              <div class="stat-label">T·ªïng ph√¥i c·∫ßn ƒë·∫∑t</div>
              <div class="stat-value" id="totalStocks">--</div>
            </div>
            <div class="stat-card">
              <div class="stat-label">T·ªïng ph·∫ø li·ªáu</div>
              <div class="stat-value" id="totalWaste">-- mm</div>
            </div>
            <div class="stat-card">
              <div class="stat-label">K√≠ch th∆∞·ªõc t·ªëi ∆∞u</div>
              <div class="stat-value" id="optimalLength">-- mm</div>
            </div>
          </div>

          <!-- Efficiency Chart -->
          <div class="chart-container">
            <canvas id="efficiencyChart"></canvas>
          </div>

          <!-- Export Actions -->
          <div class="export-section">
            <h3>üì§ Xu·∫•t d·ªØ li·ªáu</h3>
            <button
              class="btn btn-success"
              onclick="app.exportExcel()"
              disabled
              id="btnExportExcel"
            >
              üìÑ Xu·∫•t Excel
            </button>
            <button
              class="btn btn-secondary"
              onclick="app.printResults()"
              disabled
              id="btnPrint"
            >
              üñ®Ô∏è In ·∫•n
            </button>
          </div>

          <!-- Warnings -->
          <div
            id="warningsArea"
            class="warnings-area"
            style="display: none"
          ></div>
        </section>
      </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none">
      <div class="spinner"></div>
      <p>ƒêang t√≠nh to√°n...</p>
    </div>

    <!-- Libraries -->
    <!-- S·ª≠ d·ª•ng version 0.18.5 ·ªïn ƒë·ªãnh t·ª´ cdnjs -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <!-- App Scripts -->
    <script src="src/js/optimizer.js"></script>
    <script src="src/js/storage.js"></script>
    <script src="src/js/export.js"></script>
    <script src="src/js/app.js"></script>
  </body>
</html>
